---
phase: 04-optimize-memoization
plan: 01
type: execute
---

<objective>
Remove unnecessary useMemo/useCallback from custom hooks - React 19 Compiler handles memoization automatically.

Purpose: Reduce code complexity, leverage React 19's automatic optimizations, eliminate manual performance micro-management that the compiler handles better.

Output: Cleaner hooks with 20-25 fewer memoization instances, all tests passing.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-type-safety/03-03-SUMMARY.md

**Current State:**
- 122 total useMemo/useCallback instances across codebase
- React 19 with automatic memoization via Compiler
- Target: Remove 50-70 unnecessary instances (Phase 4 goal)
- This plan: Focus on hooks directory (~30-40 instances, remove 20-25)

**Constraining Decisions:**
- Maintain all 891 passing tests (Phase 1-3 pattern)
- Zero TypeScript errors (Phase 3 achievement)
- Bun runtime for all commands

**React 19 Compiler Context:**
- Automatically memoizes values and function references
- No need for manual useCallback on event handlers
- No need for useMemo on simple computations
- Only manual memoization needed: truly expensive operations (>10ms)

**What to Remove:**
- ✅ Event handlers (handleSubmit, handleChange, etc.) - Compiler handles it
- ✅ Simple data transformations (filtering, mapping) - Compiler handles it
- ✅ Derived state calculations (progress bars, validation state) - Compiler handles it
- ✅ Functions passed to context providers - Compiler handles it

**What to Keep:**
- ❌ Expensive operations with measurable performance impact (rare)
- ❌ Functions used in useEffect dependency arrays that MUST be stable (context-dependent)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove unnecessary memoization from hooks directory</name>
  <files>
    src/hooks/use-contact-form.ts,
    src/hooks/use-loading-state.ts,
    src/hooks/use-quick-view-modal.ts,
    src/hooks/use-analytics-data.ts,
    src/hooks/use-swiper-autoplay.ts,
    src/hooks/use-blog-post-form.ts,
    src/hooks/use-keyboard-navigation.ts,
    src/hooks/use-local-storage.ts
  </files>
  <action>
Scan each hook file for useMemo/useCallback instances. Remove unnecessary memoization following these rules:

**Remove useCallback from:**
- Event handlers (onClick, onChange, onSubmit, etc.) - Just use regular functions
- Functions that don't have measurable performance cost
- Simple wrappers around setState

**Remove useMemo from:**
- Simple data transformations (array.filter, array.map with simple conditions)
- Progress calculations (<10 operations)
- Derived state based on props/state

**Example transformations:**

BEFORE (unnecessary):
```typescript
const handleSubmit = useCallback(async (e: React.FormEvent) => {
  e.preventDefault()
  await submitForm()
}, [submitForm])

const progress = useMemo(() => {
  let filled = 0
  if (name.length >= 2) filled++
  return (filled / 4) * 100
}, [name])
```

AFTER (cleaner):
```typescript
const handleSubmit = async (e: React.FormEvent) => {
  e.preventDefault()
  await submitForm()
}

const progress = (() => {
  let filled = 0
  if (name.length >= 2) filled++
  return (filled / 4) * 100
})()
```

**Remove imports when no longer used:**
- If removing all useMemo, remove from import statement
- If removing all useCallback, remove from import statement
- Update to `import { useState } from 'react'` if only useState remains

**Conservative approach:**
- If uncertain about performance impact, add a comment: `// Note: Could memoize if performance issues arise`
- Focus on obvious cases: event handlers, simple computations

Target: Remove 20-25 instances from hooks directory.
  </action>
  <verify>
```bash
# Count remaining instances
grep -r "useMemo\|useCallback" src/hooks --include="*.ts" --include="*.tsx" | wc -l
# Should be ~15-20 (down from ~30-40)

# Type check still passes
bun run type-check

# No new lint warnings
bun run lint 2>&1 | grep -c "warning" || echo "0"
```
  </verify>
  <done>
- 20-25 memoization instances removed from hooks
- No TypeScript errors
- No new ESLint warnings
- All hook files still export correct types
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify tests and runtime behavior</name>
  <files>N/A (verification only)</files>
  <action>
Run full test suite and verify no regressions from removing memoization.

Tests should pass because:
- React 19 Compiler handles memoization automatically
- Hook behavior unchanged, only implementation simplified
- Event handlers still work (compiler memoizes when needed)
- Derived state still computed correctly

If tests fail:
1. Check error message - is it related to memoization or something else?
2. If memoization-related: Re-add useCallback/useMemo for that specific case with comment explaining why needed
3. If unrelated: Fix the actual issue (likely pre-existing)

Run:
```bash
bun test
```

Expected: 891/891 tests passing (same as Phase 3).
  </action>
  <verify>
```bash
# All tests pass
bun test 2>&1 | grep "891 pass"

# Production build works
bun run build
```
  </verify>
  <done>
- All 891 tests passing
- Production build successful
- No runtime errors in test output
- Hooks behave identically to before (React Compiler optimization is invisible)
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun run type-check` passes with 0 errors
- [ ] `bun test` shows 891/891 passing
- [ ] `bun run build` completes without errors
- [ ] 20-25 fewer useMemo/useCallback instances in src/hooks/
- [ ] No new lint warnings introduced
</verification>

<success_criteria>

- 20-25 useMemo/useCallback instances removed from hooks directory
- All 891 tests passing (no regressions)
- Zero TypeScript errors maintained
- Production build successful
- Code is simpler and easier to maintain
- React 19 Compiler handles optimizations transparently
  </success_criteria>

<output>
After completion, create `.planning/phases/04-optimize-memoization/04-01-SUMMARY.md`:

# Plan 04-01 Execution Summary: Remove Unnecessary Memoization from Hooks

**Executed:** [date]
**Status:** ✅ Complete
**Branch:** [branch-name]

---

## Objective

Remove unnecessary useMemo/useCallback from custom hooks - React 19 Compiler handles memoization automatically.

---

## Results Achieved

### Quantitative Metrics

| Metric | Before | After | Change |
|--------|--------|-------|--------|
| **Hooks Memoization** | ~30-40 | ~15-20 | -20-25 instances |
| **Test Status** | 891 passing | 891 passing | No regression |
| **TypeScript Errors** | 0 | 0 | Maintained |
| **Build Status** | ✅ | ✅ | No issues |

---

## Tasks Completed

### Task 1: Remove Unnecessary Memoization from Hooks Directory ✅
**Commit:** `[hash]` - refactor(04-01): remove unnecessary memoization from hooks

**Files Modified:**
- List each hook file modified with count of removals

**Actions:**
- Removed useCallback from event handlers
- Removed useMemo from simple computations
- Updated imports to remove unused React hooks

### Task 2: Verify Tests and Runtime Behavior ✅
**Verification:**
- All 891 tests passing
- Production build successful
- No new TypeScript errors or lint warnings

---

## Decisions Made

- Kept memoization for: [list any kept instances with rationale]
- React 19 Compiler trusted for automatic optimization
- Conservative approach: When uncertain, removed with note about re-adding if needed

---

## Issues Encountered

[None expected, or document any surprises]

---

## Next Step

Ready for 04-02-PLAN.md (remove memoization from components)
</output>
