# Plan 03-01: Fix Type Imports and Exports

## Objective

Fix 26 TypeScript errors related to missing type imports and exports across blog types, security logger, and analytics service. Ensures all enums are properly imported from `@/lib/prisma-types` (single source of truth) and all types are correctly exported from their source files.

## Execution Context

**Tech Stack:**
- TypeScript 5.9.3 (strict mode enabled)
- Prisma ORM with centralized enum exports (@/lib/prisma-types)
- Next.js 16 App Router (Server/Client Components)
- Bun runtime

**Constraints:**
- No barrel files/index.ts allowed (direct imports from source files)
- All 891 tests must pass after changes
- Zero downtime requirement (no breaking API changes)
- Atomic commits: One per task

**Related Files:**
- `src/types/blog.ts` - Missing enum imports, BlogPostSummary export
- `src/lib/security/security-event-logger.ts` - Missing SecurityEventType/SecuritySeverity imports
- `src/lib/prisma-types.ts` - Source of truth for all Prisma enums
- `src/types/analytics.ts` - Already exports GrowthData, YearOverYearData (no changes needed)

## Context

From Phase 2 (Nonce-Based CSP), 29 pre-existing TypeScript errors were documented as blocking production builds. These errors fall into three categories:

1. **Missing Enum Imports (blog.ts)**: Uses PostStatus, ContentType, InteractionType, SEOEventType, SEOSeverity, ChangeFrequency but doesn't import them
2. **Missing Type Exports (blog.ts)**: Imports BlogPostSummary from shared-api but doesn't re-export it
3. **Missing Type Imports (security-event-logger.ts)**: Uses SecurityEventType, SecuritySeverity but doesn't import them

**Type Check Errors (26 total):**
```
src/types/blog.ts:24:15 - error TS2304: Cannot find name 'ContentType'
src/types/blog.ts:25:11 - error TS2304: Cannot find name 'PostStatus'
src/types/blog.ts:300:9 - error TS2552: Cannot find name 'InteractionType'
src/types/blog.ts:324:9 - error TS2552: Cannot find name 'SEOEventType'
src/types/blog.ts:329:13 - error TS2304: Cannot find name 'SEOSeverity'
src/types/blog.ts:376:17 - error TS2304: Cannot find name 'ChangeFrequency'

src/lib/security/security-event-logger.ts:13:8 - error TS2304: Cannot find name 'SecurityEventType'
src/lib/security/security-event-logger.ts:14:13 - error TS2304: Cannot find name 'SecuritySeverity'

src/test/blog-factories.ts:8:3 - error TS2305: Module has no exported member 'BlogPostSummary'
```

**Verification:**
- `bun run type-check` - Should show 0 errors after fixes
- `bun test` - All 891 tests must pass
- No runtime behavior changes (types only)

## Tasks

### Task 1: Fix blog.ts enum imports and exports

**Goal**: Import all Prisma enums from `@/lib/prisma-types` and export BlogPostSummary

**Why**: blog.ts uses 6 enums (PostStatus, ContentType, InteractionType, SEOEventType, SEOSeverity, ChangeFrequency) without importing them, causing 22 type errors. Also imports BlogPostSummary from shared-api but doesn't re-export it.

**Actions:**
1. Add import statement at top of `src/types/blog.ts`:
   ```typescript
   import {
     PostStatus,
     ContentType,
     InteractionType,
     SEOEventType,
     SEOSeverity,
     ChangeFrequency,
   } from '@/lib/prisma-types'
   ```

2. Remove duplicate type-only export on line 10-11:
   ```typescript
   // DELETE THIS LINE:
   export type { PostStatus as PostStatusType, ContentType as ContentTypeType, InteractionType as InteractionTypeType, SEOEventType as SEOEventTypeType, SEOSeverity as SEOSeverityType, ChangeFrequency as ChangeFrequencyType }
   ```

3. After the import from shared-api (line 669), add re-export:
   ```typescript
   import type { BlogPostData, BlogPostSummary as APIBlogPostSummary } from './shared-api'
   
   // Add this line to re-export BlogPostSummary
   export type { APIBlogPostSummary as BlogPostSummary }
   ```

**Files Modified:**
- `src/types/blog.ts`

**Verification:**
```bash
bun run type-check 2>&1 | grep "src/types/blog.ts"
# Should show 0 errors for blog.ts
```

**Commit:**
```bash
git add src/types/blog.ts
git commit -m "fix(03-01): import Prisma enums and export BlogPostSummary in blog types

- Import PostStatus, ContentType, InteractionType, SEOEventType, SEOSeverity, ChangeFrequency from @/lib/prisma-types
- Remove duplicate type-only exports (PostStatusType, etc.)
- Re-export BlogPostSummary from shared-api for test factories
- Fixes 23 type errors in blog.ts and blog-factories.ts"
```

---

### Task 2: Fix security-event-logger.ts type imports

**Goal**: Import SecurityEventType and SecuritySeverity from `@/lib/prisma-types`

**Why**: security-event-logger.ts uses SecurityEventType and SecuritySeverity in SecurityEventInput interface but doesn't import them, causing 4 type errors.

**Actions:**
1. Add import statement at top of `src/lib/security/security-event-logger.ts` after other imports:
   ```typescript
   import { SecurityEventType, SecuritySeverity } from '@/lib/prisma-types'
   ```

**Files Modified:**
- `src/lib/security/security-event-logger.ts`

**Verification:**
```bash
bun run type-check 2>&1 | grep "security-event-logger.ts"
# Should show 0 errors for security-event-logger.ts
```

**Commit:**
```bash
git add src/lib/security/security-event-logger.ts
git commit -m "fix(03-01): import SecurityEventType and SecuritySeverity from Prisma types

- Import SecurityEventType and SecuritySeverity from @/lib/prisma-types
- Fixes 4 type errors in security-event-logger.ts
- No runtime behavior changes (types only)"
```

---

### Task 3: Verify type safety improvements

**Goal**: Run full type check and test suite to confirm all type import/export errors resolved

**Why**: Ensures changes don't introduce regressions and all 26 type errors from blog.ts, security-event-logger.ts, and blog-factories.ts are fixed.

**Actions:**
1. Run type check:
   ```bash
   bun run type-check
   ```
   Expected: Errors reduced from 29 to 3 (unused variables in test files)

2. Run test suite:
   ```bash
   bun test
   ```
   Expected: All 891 tests passing

3. Verify specific files:
   ```bash
   bun run type-check 2>&1 | grep -E "(blog\.ts|security-event-logger\.ts|blog-factories\.ts)"
   ```
   Expected: 0 errors for these files

**Files Modified:**
- None (verification only)

**Verification:**
- Type check passes with only 3 unused variable warnings remaining
- All 891 tests pass
- No errors in blog.ts, security-event-logger.ts, blog-factories.ts

**Commit:**
None (verification task)

## Success Criteria

- [ ] All 26 type errors in blog.ts, security-event-logger.ts, blog-factories.ts resolved
- [ ] blog.ts imports 6 Prisma enums from @/lib/prisma-types (no duplicate exports)
- [ ] blog.ts re-exports BlogPostSummary from shared-api
- [ ] security-event-logger.ts imports SecurityEventType and SecuritySeverity
- [ ] `bun run type-check` shows only 3 unused variable errors (down from 29)
- [ ] All 891 tests passing
- [ ] 3 commits created (2 task commits)

## Output

**Modified Files:**
- `src/types/blog.ts` - Added enum imports, removed duplicate type exports, re-exported BlogPostSummary
- `src/lib/security/security-event-logger.ts` - Added SecurityEventType/SecuritySeverity imports

**Metrics:**
- Type errors fixed: 26
- Type errors remaining: 3 (unused variables in test files)
- Test status: 891/891 passing
- Breaking changes: 0
