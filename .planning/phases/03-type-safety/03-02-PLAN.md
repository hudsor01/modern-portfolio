# Plan 03-02: Clean Up Unused Variables

## Objective

Fix the final 3 TypeScript errors by removing or marking unused variables in test utilities. Achieves Phase 3 goal of production-ready type safety with zero type errors.

## Execution Context

**Tech Stack:**
- TypeScript 5.9.3 (strict mode with noUnusedLocals, noUnusedParameters)
- Bun Test (test runner)
- Testing Library (React testing utilities)

**Constraints:**
- No barrel files/index.ts allowed (direct imports)
- All 891 tests must pass after changes
- Don't remove utilities that may be useful in future (comment them instead)
- Atomic commits: One per task

**Related Files:**
- `src/test/utils.tsx` - 3 unused test factory imports
- `src/lib/db.ts` - 1 unused Prisma variable

## Context

After Plan 03-01 fixed 26 type import/export errors, only 3 unused variable warnings remain:

**Type Check Errors (3 total):**
```
src/test/utils.tsx:9:3 - error TS6133: 'createTestDataFactory' is declared but its value is never read
src/test/utils.tsx:10:3 - error TS6133: 'createMockFunction' is declared but its value is never read
src/test/utils.tsx:11:3 - error TS6133: 'runPropertyTest' is declared but its value is never read

src/lib/db.ts:5:7 - error TS6133: 'Prisma' is declared but never used
```

**Analysis:**
1. `src/test/utils.tsx` imports 3 utilities from test-factories but never uses them
2. `src/lib/db.ts` imports Prisma namespace but doesn't use it (may be needed for types)

**Verification:**
- `bun run type-check` - Should show 0 errors after fixes
- `bun test` - All 891 tests must pass
- No functional changes (unused code removal only)

## Tasks

### Task 1: Remove unused test factory imports

**Goal**: Remove unused imports from test utilities while preserving useful utilities

**Why**: TypeScript strict mode flags these 3 imports as unused, preventing production builds. Removing them cleans up the codebase without affecting test functionality.

**Actions:**
1. Edit `src/test/utils.tsx` line 8-13:
   ```typescript
   // BEFORE:
   import {
     createTestDataFactory,
     createMockFunction,
     runPropertyTest,
     createMockResponse,
   } from './test-factories'
   
   // AFTER:
   import {
     createMockResponse,
   } from './test-factories'
   ```

2. Verify no tests use these imports:
   ```bash
   grep -r "createTestDataFactory\|createMockFunction\|runPropertyTest" src/test/
   ```
   Expected: No usage found (only import declaration)

**Files Modified:**
- `src/test/utils.tsx`

**Verification:**
```bash
bun run type-check 2>&1 | grep "test/utils.tsx"
# Should show 0 errors

bun test
# All 891 tests should pass
```

**Commit:**
```bash
git add src/test/utils.tsx
git commit -m "fix(03-02): remove unused test factory imports from test utils

- Remove createTestDataFactory (unused)
- Remove createMockFunction (unused)
- Remove runPropertyTest (unused)
- Keep createMockResponse (actively used)
- Fixes 3 TS6133 errors in test/utils.tsx"
```

---

### Task 2: Handle unused Prisma variable in db.ts

**Goal**: Remove or properly use the Prisma import in db.ts

**Why**: TypeScript flags Prisma as unused, but it may be needed for type references. Need to verify if it's truly unused or if it's used for type annotations.

**Actions:**
1. Read `src/lib/db.ts` to understand Prisma usage:
   ```bash
   cat src/lib/db.ts
   ```

2. **If Prisma is used for types:**
   - Convert to type-only import:
     ```typescript
     import { PrismaClient, type Prisma } from '@/prisma/client'
     ```

3. **If Prisma is completely unused:**
   - Remove the Prisma import entirely:
     ```typescript
     import { PrismaClient } from '@/prisma/client'
     ```

4. Run type-check to verify:
   ```bash
   bun run type-check 2>&1 | grep "lib/db.ts"
   ```

**Files Modified:**
- `src/lib/db.ts`

**Verification:**
```bash
bun run type-check 2>&1 | grep "db.ts"
# Should show 0 errors

bun test
# All 891 tests should pass
```

**Commit:**
```bash
git add src/lib/db.ts
git commit -m "fix(03-02): remove unused Prisma import from db.ts

- Remove unused Prisma namespace import
- Keep PrismaClient (actively used)
- Fixes TS6133 error in lib/db.ts
- No runtime behavior changes"
```

---

### Task 3: Verify zero TypeScript errors

**Goal**: Confirm Phase 3 goal achieved - zero TypeScript errors, production build ready

**Why**: Final verification that all type safety issues from Phase 3 are resolved. Confirms production build will succeed.

**Actions:**
1. Run full type check:
   ```bash
   bun run type-check
   ```
   Expected: 0 errors, 0 warnings

2. Run full test suite:
   ```bash
   bun test
   ```
   Expected: All 891 tests passing

3. Attempt production build:
   ```bash
   bun run build
   ```
   Expected: Build succeeds without type errors

4. Check error count reduction:
   - Phase 2 (baseline): 29 errors
   - After Plan 03-01: 3 errors
   - After Plan 03-02: 0 errors

**Files Modified:**
- None (verification only)

**Verification:**
- `bun run type-check` shows 0 errors
- All 891 tests passing
- `bun run build` succeeds
- No type-related warnings in output

**Commit:**
None (verification task)

## Success Criteria

- [ ] All 3 unused variable errors resolved
- [ ] `bun run type-check` shows 0 errors (down from 29 at Phase 2 end)
- [ ] All 891 tests passing
- [ ] `bun run build` succeeds without type errors
- [ ] 2 commits created (2 task commits)
- [ ] Phase 3 goal achieved: Reduce non-test `any` types and fix all TypeScript errors

## Output

**Modified Files:**
- `src/test/utils.tsx` - Removed 3 unused test factory imports
- `src/lib/db.ts` - Removed or properly typed unused Prisma import

**Metrics:**
- Type errors fixed: 3
- Total type errors fixed in Phase 3: 29 (26 in Plan 03-01 + 3 in Plan 03-02)
- Type errors remaining: 0
- Test status: 891/891 passing
- Production build: âœ… Ready
